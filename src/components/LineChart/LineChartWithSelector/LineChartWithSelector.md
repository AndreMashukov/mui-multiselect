<p style="font-size: 1.5em;">**NOTE!** Tooltips for data points are not shown correctly when multiple stories are displayed on the same page</p>

<p style="font-size: 1.5em;">**NOTE!** **LineChartThresholdSegment** component has performance limitation depending on number of data points and thresholds (the component is yet to be optimised). </p>

The `LineChartWithSelector` component is a React component that displays a line chart with additional functionalities such as date range selection and time scale adjustment.

The `LineChartWithSelector` component uses the `ZoomableLineChart` component for rendering the line chart and `RangePickerWithSelector` for date range selection.

### Usage

To use the `LineChartWithSelector` component, simply import it and include it in your JSX:

```jsx
import React from "react";
import LineChartWithSelector from "./LineChartWithSelector";
import useLineChartWithSelector from "./useLineChartWithSelector";

function App() {
  const {form, timeScaleStep, data, handleTimeScaleChange, filterByDateRange} =
    useLineChartWithSelector();

  return (
    <LineChartWithSelector
      form={form}
      timeScaleStep={timeScaleStep}
      data={data.map(filterByDateRange)}
      handleTimeScaleChange={handleTimeScaleChange}
    />
  );
}
```

| Prop                      | Type                                                                                                | Description |
| ------------------------- | --------------------------------------------------------------------------------------------------- | ----------- |
| **data**                  | Array of data points to be displayed in the chart.                                                  |
| **form**                  | Form object for managing the date range selection. react-hook-form is used to manage the form state |
| **timeScaleStep**         | The current time scale step for data aggregation                                                    |
| **handleTimeScaleChange** | Function to handle changes in the time scale step                                                   |

### form

`form` represents an object generated by react-hook-form library that is responsible for state management and validation of dates for date range picker.

Here is an example of how dateRangeForm could be decalred

```jsx
import {
  useForm,
  Control,
  UseFormSetValue,
  UseFormTrigger,
  UseFormGetValues,
  FieldErrors,
} from "react-hook-form";

const schema = yup.object().shape({
  startDate: yup
    .mixed()
    .test("is-moment", "Start date must be a valid moment object", (value) =>
      moment.isMoment(value)
    )
    .required("Start date is required"),
  endDate: yup
    .mixed()
    .test("is-moment", "End date must be a valid moment object", (value) =>
      moment.isMoment(value)
    )
    .test(
      "is-after-start",
      "End date must be later than start date",
      function (value) {
        const {startDate} = this.parent;
        return !value || !startDate || startDate.isBefore(value);
      }
    )
    .required("End date is required"),
  rangeOption: yup
    .string()
    .required("Range option is required")
    .oneOf(["day", "week", "month", "year"]),
});

export const useCustomRangePickerForm = (): UseCustomRangePickerFormReturn => {
  const {
    control,
    setValue,
    trigger,
    getValues,
    formState: {errors},
  } = useForm<FormValues>({
    resolver: yupResolver(schema),
    defaultValues: {
      startDate: moment().subtract(1, "week"),
      endDate: moment(),
      rangeOption: "week",
    },
  });

  return {control, setValue, trigger, getValues, errors};
};
```
